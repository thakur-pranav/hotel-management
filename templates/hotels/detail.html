{% extends 'base.html' %}

{% block title %}{{ hotel.hotel_name }} - Hotel Management System{% endblock %}

{% block content %}
<h1>{{ hotel.hotel_name }}</h1>
<p><strong>Location:</strong> {{ hotel.location }}</p>
<p><strong>Star Rating:</strong> {{ hotel.star_rating }} Stars</p>
<p><strong>Amenities:</strong> {{ hotel.amenities }}</p>
<p>{{ hotel.description }}</p>

{% if hotel.image_path %}
<img src="{{ url_for('static', filename=hotel.image_path) }}" alt="{{ hotel.hotel_name }}" class="img-fluid mb-4" style="max-height: 300px;">
{% endif %}

<div class="card mb-4">
    <div class="card-header bg-light">
        <h5 class="mb-0">Check Availability</h5>
    </div>
    <div class="card-body">
        <form method="GET" action="{{ url_for('hotel_detail', hotel_id=hotel.hotel_id) }}">
            <div class="row">
                <div class="col-md-5">
                    <div class="mb-3">
                        <label for="check_in" class="form-label">Check-in Date</label>
                        <input type="date" class="form-control" id="check_in" name="check_in" value="{{ check_in or '' }}">
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="mb-3">
                        <label for="check_out" class="form-label">Check-out Date</label>
                        <input type="date" class="form-control" id="check_out" name="check_out" value="{{ check_out or '' }}">
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="mb-3">
                        <label class="form-label d-block">Â </label>
                        <button type="submit" class="btn btn-primary">Check</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<h2>Available Rooms</h2>
<div class="row">
    {% for room in rooms %}
    <div class="col-md-4 mb-4">
        <div class="card">
            <div class="row g-0">
                <div class="col-md-4">
                    {% if room.image_path %}
                    <img src="{{ url_for('static', filename=room.image_path) }}" class="img-fluid rounded-start h-100" alt="{{ room.room_type }}">
                    {% else %}
                    <img src="{{ url_for('static', filename='images/default-room.jpg') }}" class="img-fluid rounded-start h-100" alt="Default Room">
                    {% endif %}
                </div>
                <div class="col-md-8">
                    <div class="card-body">
                        <h5 class="card-title">{{ room.room_type }}</h5>
                        <p class="card-text"><strong>Price:</strong> ${{ "%.2f"|format(room.price_per_night) }} per night</p>
                        <p class="card-text"><strong>Capacity:</strong> {{ room.capacity }} {% if room.capacity == 1 %}person{% else %}people{% endif %}</p>
                        <p class="card-text"><strong>Features:</strong> {{ room.features }}</p>
                        <p class="card-text"><strong>Status:</strong> {% if check_in and check_out %}Available{% else %}Check Dates{% endif %}</p>
                        {% if check_in and check_out %}
                        <a href="{{ url_for('book_room', room_id=room.room_id) }}?check_in={{ check_in }}&check_out={{ check_out }}" class="btn btn-success">Book Now</a>
                        {% else %}
                        <button class="btn btn-secondary" disabled>Check Dates</button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% if not rooms %}
<p>No rooms available for the selected dates.</p>
{% endif %}

<h2>Reviews</h2>
{% for review in reviews %}
<div class="card mb-2">
    <div class="card-body">
        <h5 class="card-title">{{ review.username }} - {{ review.rating }} Stars</h5>
        <p class="card-text">{{ review.comment }}</p>
        <p class="card-text"><small class="text-muted">{{ review.review_date }}</small></p>
    </div>
</div>
{% endfor %}

{% if session.logged_in %}
<h3>Submit a Review</h3>
<form method="POST" action="{{ url_for('submit_review', hotel_id=hotel.hotel_id) }}">
    <div class="mb-3">
        <label for="rating" class="form-label">Rating</label>
        <select class="form-select" id="rating" name="rating" required>
            <option value="1">1 Star</option>
            <option value="2">2 Stars</option>
            <option value="3">3 Stars</option>
            <option value="4">4 Stars</option>
            <option value="5">5 Stars</option>
        </select>
    </div>
    <div class="mb-3">
        <label for="comment" class="form-label">Comment</label>
        <textarea class="form-control" id="comment" name="comment" rows="4" required></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Submit Review</button>
</form>
{% endif %}
{% endblock %}